<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Resolves conditional compilation for `features` section in the manifest."><title>cargo::core::resolver::features - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../../static.files/rustdoc-315b6ef5d9c5102a.css"><meta name="rustdoc-vars" data-root-path="../../../../" data-static-root-path="../../../../static.files/" data-current-crate="cargo" data-themes="" data-resource-suffix="" data-rustdoc-version="1.82.0-dev" data-channel="nightly" data-search-js="search-c3d282121a07da8d.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../../../../static.files/storage-118b08c4c78b968e.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../../../static.files/main-66622e6c9347fbca.js"></script><noscript><link rel="stylesheet" href="../../../../static.files/noscript-3b12f09e550e0385.css"></noscript><link rel="alternate icon" type="image/png" href="../../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../../cargo/index.html">cargo</a><span class="version">1.82.0-dev</span></h2></div><h2 class="location"><a href="#">Module features</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#types">Type Aliases</a></li></ul></section><h2><a href="../index.html">In cargo::<wbr>core::<wbr>resolver</a></h2></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../../../index.html">cargo</a>::<wbr><a href="../../index.html">core</a>::<wbr><a href="../index.html">resolver</a>::<wbr><a class="mod" href="#">features</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><a class="src" href="../../../../src/cargo/core/resolver/features.rs.html#1-980">source</a> Â· <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Resolves conditional compilation for <a href="https://doc.rust-lang.org/nightly/cargo/reference/features.html"><code>features</code> section</a> in the manifest.</p>
<p>This is a <a href="https://doc.rust-lang.org/nightly/cargo/reference/resolver.html#feature-resolver-version-2">new feature resolver</a> that runs independently of the main
dependency resolver. It has several options which can enable new feature
resolution behavior.</p>
<p>One of its key characteristics is that it can avoid unifying features for
shared dependencies in some situations. See <a href="struct.FeatureOpts.html" title="struct cargo::core::resolver::features::FeatureOpts"><code>FeatureOpts</code></a> for the
different behaviors that can be enabled. If no extra options are enabled,
then it should behave exactly the same as the dependency resolverâ€™s
feature resolution.</p>
<p>The preferred way to engage this new resolver is via <a href="../../../ops/resolve/fn.resolve_ws_with_opts.html" title="fn cargo::ops::resolve::resolve_ws_with_opts"><code>resolve_ws_with_opts</code></a>.</p>
<p>This does not <em>replace</em> feature resolution in the dependency resolver, but
instead acts as a second pass which can <em>narrow</em> the features selected in
the dependency resolver. The dependency resolver still needs to do its own
feature resolution in order to avoid selecting optional dependencies that
are never enabled. The dependency resolver could, in theory, just assume
all optional dependencies on all packages are enabled (and remove all
knowledge of features), but that could introduce new requirements that
might change old behavior or cause conflicts. Maybe some day in the future
we could experiment with that, but it seems unlikely to work or be all
that helpful.</p>
<h3 id="assumptions"><a class="doc-anchor" href="#assumptions">Â§</a>Assumptions</h3>
<p>There are many assumptions made about the dependency resolver:</p>
<ul>
<li>Assumes feature validation has already been done during the construction
of feature maps, so the feature resolver doesnâ€™t do that validation at all.</li>
<li>Assumes <code>dev-dependencies</code> within a dependency have been removed
in the given <a href="../resolve/struct.Resolve.html" title="struct cargo::core::resolver::resolve::Resolve"><code>Resolve</code></a>.</li>
</ul>
<p>There are probably other assumptions that I am forgetting.</p>
</div></details><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.CliFeatures.html" title="struct cargo::core::resolver::features::CliFeatures">CliFeatures</a></div><div class="desc docblock-short">Features specified on the command-line.</div></li><li><div class="item-name"><a class="struct" href="struct.FeatureOpts.html" title="struct cargo::core::resolver::features::FeatureOpts">Feature<wbr>Opts</a></div><div class="desc docblock-short">Options for how the feature resolver works.</div></li><li><div class="item-name"><a class="struct" href="struct.FeatureResolver.html" title="struct cargo::core::resolver::features::FeatureResolver">Feature<wbr>Resolver</a></div><div class="desc docblock-short">The new feature resolver that <a href="struct.FeatureResolver.html#method.resolve" title="associated function cargo::core::resolver::features::FeatureResolver::resolve"><code>resolve</code></a>s your project.</div></li><li><div class="item-name"><a class="struct" href="struct.ResolvedFeatures.html" title="struct cargo::core::resolver::features::ResolvedFeatures">Resolved<wbr>Features</a></div><div class="desc docblock-short">Set of all activated features for all packages in the resolve graph.</div></li></ul><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.FeaturesFor.html" title="enum cargo::core::resolver::features::FeaturesFor">Features<wbr>For</a></div><div class="desc docblock-short">Flag to indicate if features are requested for a certain type of dependency.</div></li><li><div class="item-name"><a class="enum" href="enum.ForceAllTargets.html" title="enum cargo::core::resolver::features::ForceAllTargets">Force<wbr>AllTargets</a></div><div class="desc docblock-short">Flag to indicate that target-specific filtering should be disabled.</div></li><li><div class="item-name"><a class="enum" href="enum.HasDevUnits.html" title="enum cargo::core::resolver::features::HasDevUnits">HasDev<wbr>Units</a></div><div class="desc docblock-short">Flag to indicate if Cargo is building <em>any</em> dev units (tests, examples, etc.).</div></li><li><div class="item-name"><a class="enum" href="enum.RequestedFeatures.html" title="enum cargo::core::resolver::features::RequestedFeatures">Requested<wbr>Features</a></div><div class="desc docblock-short">Features flags requested for a package.</div></li></ul><h2 id="types" class="section-header">Type Aliases<a href="#types" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="type" href="type.ActivateMap.html" title="type cargo::core::resolver::features::ActivateMap">Activate<wbr>Map</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Map of activated features.</div></li><li><div class="item-name"><a class="type" href="type.DiffMap.html" title="type cargo::core::resolver::features::DiffMap">DiffMap</a></div><div class="desc docblock-short">Map of differences.</div></li><li><div class="item-name"><a class="type" href="type.PackageFeaturesKey.html" title="type cargo::core::resolver::features::PackageFeaturesKey">Package<wbr>Features<wbr>Key</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">The key used in various places to store features for a particular dependency.
The actual discrimination happens with the <a href="enum.FeaturesFor.html" title="enum cargo::core::resolver::features::FeaturesFor"><code>FeaturesFor</code></a> type.</div></li></ul></section></div></main></body></html>