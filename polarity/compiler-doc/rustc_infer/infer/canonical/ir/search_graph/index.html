<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="The search graph is responsible for caching and cycle detection in the trait solver. Making sure that caching doesn’t result in soundness bugs or unstable query results is very challenging and makes this one of the most-involved self-contained components of the compiler."><title>rustc_infer::infer::canonical::ir::search_graph - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../../../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../../../../static.files/rustdoc-e56847b5.css"><meta name="rustdoc-vars" data-root-path="../../../../../" data-static-root-path="../../../../../static.files/" data-current-crate="rustc_infer" data-themes="" data-resource-suffix="" data-rustdoc-version="1.91.0-dev" data-channel="nightly" data-search-js="search-38ac1f3e.js" data-stringdex-js="stringdex-0e748618.js" data-settings-js="settings-c38705f0.js" ><script src="../../../../../static.files/storage-e2aeef58.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../../../../static.files/main-6dc2a7f3.js"></script><noscript><link rel="stylesheet" href="../../../../../static.files/noscript-263c88ec.css"></noscript><link rel="alternate icon" type="image/png" href="../../../../../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../../../../../static.files/favicon-044be391.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">Module search_graph</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><a class="logo-container" href="../../../../../rustc_infer/index.html"><img class="rust-logo" src="../../../../../static.files/rust-logo-9a9549ea.svg" alt="logo"></a><h2><a href="../../../../../rustc_infer/index.html">rustc_<wbr>infer</a><span class="version">1.91.0-dev</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module search_<wbr>graph</a></h2><h3><a href="#structs">Module Items</a></h3><ul class="block"><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#enums" title="Enums">Enums</a></li><li><a href="#traits" title="Traits">Traits</a></li></ul></section><div id="rustdoc-modnav"><h2><a href="../index.html">In rustc_<wbr>infer::<wbr>infer::<wbr>canonical::<wbr>ir</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../../../../index.html">rustc_infer</a>::<wbr><a href="../../../index.html">infer</a>::<wbr><a href="../../index.html">canonical</a>::<wbr><a href="../index.html">ir</a></div><h1>Module <span>search_<wbr>graph</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../../../src/rustc_type_ir/lib.rs.html#34">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>The search graph is responsible for caching and cycle detection in the trait
solver. Making sure that caching doesn’t result in soundness bugs or unstable
query results is very challenging and makes this one of the most-involved
self-contained components of the compiler.</p>
<p>We added fuzzing support to test its correctness. The fuzzers used to verify
the current implementation can be found in <a href="https://github.com/lcnr/search_graph_fuzz">https://github.com/lcnr/search_graph_fuzz</a>.</p>
<p>This is just a quick overview of the general design, please check out the relevant
<a href="https://rustc-dev-guide.rust-lang.org/solve/caching.html">rustc-dev-guide chapter</a> for
more details. Caching is split between a global cache and the per-cycle <code>provisional_cache</code>.
The global cache has to be completely unobservable, while the per-cycle cache may impact
behavior as long as the resulting behavior is still correct.</p>
</div></details><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><dl class="item-table"><dt><a class="struct" href="struct.CandidateHeadUsages.html" title="struct rustc_infer::infer::canonical::ir::search_graph::CandidateHeadUsages">Candidate<wbr>Head<wbr>Usages</a></dt><dt><a class="struct" href="struct.GlobalCache.html" title="struct rustc_infer::infer::canonical::ir::search_graph::GlobalCache">Global<wbr>Cache</a></dt><dt><a class="struct" href="struct.PathsToNested.html" title="struct rustc_infer::infer::canonical::ir::search_graph::PathsToNested">Paths<wbr>ToNested</a></dt><dd>Tracks how nested goals have been accessed. This is necessary to disable
global cache entries if computing them would otherwise result in a cycle or
access a provisional cache entry.</dd><dt><a class="struct" href="struct.SearchGraph.html" title="struct rustc_infer::infer::canonical::ir::search_graph::SearchGraph">Search<wbr>Graph</a></dt></dl><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">§</a></h2><dl class="item-table"><dt><a class="enum" href="enum.PathKind.html" title="enum rustc_infer::infer::canonical::ir::search_graph::PathKind">Path<wbr>Kind</a></dt><dd>In the initial iteration of a cycle, we do not yet have a provisional
result. In the case we return an initial provisional result depending
on the kind of cycle.</dd></dl><h2 id="traits" class="section-header">Traits<a href="#traits" class="anchor">§</a></h2><dl class="item-table"><dt><a class="trait" href="trait.Cx.html" title="trait rustc_infer::infer::canonical::ir::search_graph::Cx">Cx</a></dt><dd>The search graph does not simply use <code>Interner</code> directly
to enable its fuzzing without having to stub the rest of
the interner. We don’t make this a super trait of <code>Interner</code>
as users of the shared type library shouldn’t have to care
about <code>Input</code> and <code>Result</code> as they are implementation details
of the search graph.</dd><dt><a class="trait" href="trait.Delegate.html" title="trait rustc_infer::infer::canonical::ir::search_graph::Delegate">Delegate</a></dt></dl></section></div></main></body></html>