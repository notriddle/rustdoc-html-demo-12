<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Resolves conditional compilation for `features` section in the manifest."><title>cargo::core::resolver::features - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../../../static.files/rustdoc-aa0817cf.css"><meta name="rustdoc-vars" data-root-path="../../../../" data-static-root-path="../../../../static.files/" data-current-crate="cargo" data-themes="" data-resource-suffix="" data-rustdoc-version="1.90.0-beta.1 (788da80fc 2025-08-04)" data-channel="beta" data-search-js="search-fa3e91e5.js" data-settings-js="settings-5514c975.js" ><script src="../../../../static.files/storage-68b7e25d.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../../../static.files/main-eebb9057.js"></script><noscript><link rel="stylesheet" href="../../../../static.files/noscript-32bb7600.css"></noscript><link rel="alternate icon" type="image/png" href="../../../../static.files/favicon-32x32-6580c154.png"><link rel="icon" type="image/svg+xml" href="../../../../static.files/favicon-044be391.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../../cargo/index.html">cargo</a><span class="version">1.91.0-dev</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module features</a></h2><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#assumptions" title="Assumptions">Assumptions</a></li></ul><h3><a href="#structs">Module Items</a></h3><ul class="block"><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#enums" title="Enums">Enums</a></li><li><a href="#types" title="Type Aliases">Type Aliases</a></li></ul></section><div id="rustdoc-modnav"><h2><a href="../index.html">In cargo::<wbr>core::<wbr>resolver</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../../../index.html">cargo</a>::<wbr><a href="../../index.html">core</a>::<wbr><a href="../index.html">resolver</a></div><h1>Module <span>features</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../../src/cargo/core/resolver/features.rs.html#1-971">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Resolves conditional compilation for <a href="https://doc.rust-lang.org/nightly/cargo/reference/features.html"><code>features</code> section</a> in the manifest.</p>
<p>This is a <a href="https://doc.rust-lang.org/nightly/cargo/reference/resolver.html#feature-resolver-version-2">new feature resolver</a> that runs independently of the main
dependency resolver. It has several options which can enable new feature
resolution behavior.</p>
<p>One of its key characteristics is that it can avoid unifying features for
shared dependencies in some situations. See <a href="struct.FeatureOpts.html" title="struct cargo::core::resolver::features::FeatureOpts"><code>FeatureOpts</code></a> for the
different behaviors that can be enabled. If no extra options are enabled,
then it should behave exactly the same as the dependency resolver’s
feature resolution.</p>
<p>The preferred way to engage this new resolver is via <a href="../../../ops/fn.resolve_ws_with_opts.html" title="fn cargo::ops::resolve_ws_with_opts"><code>resolve_ws_with_opts</code></a>.</p>
<p>This does not <em>replace</em> feature resolution in the dependency resolver, but
instead acts as a second pass which can <em>narrow</em> the features selected in
the dependency resolver. The dependency resolver still needs to do its own
feature resolution in order to avoid selecting optional dependencies that
are never enabled. The dependency resolver could, in theory, just assume
all optional dependencies on all packages are enabled (and remove all
knowledge of features), but that could introduce new requirements that
might change old behavior or cause conflicts. Maybe some day in the future
we could experiment with that, but it seems unlikely to work or be all
that helpful.</p>
<h3 id="assumptions"><a class="doc-anchor" href="#assumptions">§</a>Assumptions</h3>
<p>There are many assumptions made about the dependency resolver:</p>
<ul>
<li>Assumes feature validation has already been done during the construction
of feature maps, so the feature resolver doesn’t do that validation at all.</li>
<li>Assumes <code>dev-dependencies</code> within a dependency have been removed
in the given <a href="../struct.Resolve.html" title="struct cargo::core::resolver::Resolve"><code>Resolve</code></a>.</li>
</ul>
<p>There are probably other assumptions that I am forgetting.</p>
</div></details><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><dl class="item-table"><dt><a class="struct" href="struct.CliFeatures.html" title="struct cargo::core::resolver::features::CliFeatures">CliFeatures</a></dt><dd>Features specified on the command-line.</dd><dt><a class="struct" href="struct.FeatureOpts.html" title="struct cargo::core::resolver::features::FeatureOpts">Feature<wbr>Opts</a></dt><dd>Options for how the feature resolver works.</dd><dt><a class="struct" href="struct.FeatureResolver.html" title="struct cargo::core::resolver::features::FeatureResolver">Feature<wbr>Resolver</a></dt><dd>The new feature resolver that <a href="struct.FeatureResolver.html#method.resolve" title="associated function cargo::core::resolver::features::FeatureResolver::resolve"><code>resolve</code></a>s your project.</dd><dt><a class="struct" href="struct.ResolvedFeatures.html" title="struct cargo::core::resolver::features::ResolvedFeatures">Resolved<wbr>Features</a></dt><dd>Set of all activated features for all packages in the resolve graph.</dd></dl><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">§</a></h2><dl class="item-table"><dt><a class="enum" href="enum.FeaturesFor.html" title="enum cargo::core::resolver::features::FeaturesFor">Features<wbr>For</a></dt><dd>Flag to indicate if features are requested for a certain type of dependency.</dd><dt><a class="enum" href="enum.ForceAllTargets.html" title="enum cargo::core::resolver::features::ForceAllTargets">Force<wbr>AllTargets</a></dt><dd>Flag to indicate that target-specific filtering should be disabled.</dd><dt><a class="enum" href="enum.HasDevUnits.html" title="enum cargo::core::resolver::features::HasDevUnits">HasDev<wbr>Units</a></dt><dd>Flag to indicate if Cargo is building <em>any</em> dev units (tests, examples, etc.).</dd><dt><a class="enum" href="enum.RequestedFeatures.html" title="enum cargo::core::resolver::features::RequestedFeatures">Requested<wbr>Features</a></dt><dd>Features flags requested for a package.</dd></dl><h2 id="types" class="section-header">Type Aliases<a href="#types" class="anchor">§</a></h2><dl class="item-table"><dt><a class="type" href="type.ActivateMap.html" title="type cargo::core::resolver::features::ActivateMap">Activate<wbr>Map</a></dt><dd>Map of activated features.</dd><dt><a class="type" href="type.DiffMap.html" title="type cargo::core::resolver::features::DiffMap">DiffMap</a></dt><dd>Map of differences.</dd><dt><a class="type" href="type.PackageFeaturesKey.html" title="type cargo::core::resolver::features::PackageFeaturesKey">Package<wbr>Features<wbr>Key</a></dt><dd>The key used in various places to store features for a particular dependency.
The actual discrimination happens with the <a href="enum.FeaturesFor.html" title="enum cargo::core::resolver::features::FeaturesFor"><code>FeaturesFor</code></a> type.</dd></dl></section></div></main></body></html>