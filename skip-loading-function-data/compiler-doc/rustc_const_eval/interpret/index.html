<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="An interpreter for MIR used in CTFE and by miri"><title>rustc_const_eval::interpret - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../static.files/rustdoc-aa0817cf.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="rustc_const_eval" data-themes="" data-resource-suffix="" data-rustdoc-version="1.90.0-beta.1 (788da80fc 2025-08-04)" data-channel="beta" data-search-js="search-fa3e91e5.js" data-settings-js="settings-5514c975.js" ><script src="../../static.files/storage-68b7e25d.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../static.files/main-eebb9057.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-32bb7600.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-6580c154.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-044be391.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button><a class="logo-container" href="../../rustc_const_eval/index.html"><img class="rust-logo" src="../../static.files/rust-logo-9a9549ea.svg" alt=""></a></nav><nav class="sidebar"><div class="sidebar-crate"><a class="logo-container" href="../../rustc_const_eval/index.html"><img class="rust-logo" src="../../static.files/rust-logo-9a9549ea.svg" alt="logo"></a><h2><a href="../../rustc_const_eval/index.html">rustc_<wbr>const_<wbr>eval</a><span class="version">1.91.0-dev</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module interpret</a></h2><h3><a href="#modules">Module Items</a></h3><ul class="block"><li><a href="#modules" title="Modules">Modules</a></li><li><a href="#macros" title="Macros">Macros</a></li><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#enums" title="Enums">Enums</a></li><li><a href="#traits" title="Traits">Traits</a></li><li><a href="#functions" title="Functions">Functions</a></li></ul></section><div id="rustdoc-modnav"><h2 class="in-crate"><a href="../index.html">In crate rustc_<wbr>const_<wbr>eval</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../index.html">rustc_const_eval</a></div><h1>Module <span>interpret</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../src/rustc_const_eval/interpret/mod.rs.html#1-43">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>An interpreter for MIR used in CTFE and by miri</p>
</div></details><h2 id="reexports" class="section-header">Re-exports<a href="#reexports" class="anchor">§</a></h2><dl class="item-table reexports"><dt><code>pub use rustc_middle::mir::<a class="mod" href="../../rustc_middle/mir/interpret/index.html" title="mod rustc_middle::mir::interpret">interpret</a>::*;</code></dt></dl><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">§</a></h2><dl class="item-table"><dt><a class="mod" href="call/index.html" title="mod rustc_const_eval::interpret::call">call</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Manages calling a concrete function (with known MIR body) with argument passing,
and returning the return value to the caller.</dd><dt><a class="mod" href="cast/index.html" title="mod rustc_const_eval::interpret::cast">cast</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dt><a class="mod" href="discriminant/index.html" title="mod rustc_const_eval::interpret::discriminant">discriminant</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Functions for reading and writing discriminants of multi-variant layouts (enums and coroutines).</dd><dt><a class="mod" href="eval_context/index.html" title="mod rustc_const_eval::interpret::eval_context">eval_<wbr>context</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dt><a class="mod" href="intern/index.html" title="mod rustc_const_eval::interpret::intern">intern</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>This module specifies the type based interner for constants.</dd><dt><a class="mod" href="intrinsics/index.html" title="mod rustc_const_eval::interpret::intrinsics">intrinsics</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Intrinsics and other functions that the interpreter executes without
looking at their MIR. Intrinsics/functions supported here are shared by CTFE
and miri.</dd><dt><a class="mod" href="machine/index.html" title="mod rustc_const_eval::interpret::machine">machine</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>This module contains everything needed to instantiate an interpreter.
This separation exists to ensure that no fancy miri features like
interpreting common C functions leak into CTFE.</dd><dt><a class="mod" href="memory/index.html" title="mod rustc_const_eval::interpret::memory">memory</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>The memory subsystem.</dd><dt><a class="mod" href="operand/index.html" title="mod rustc_const_eval::interpret::operand">operand</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Functions concerning immediate values and operands, and reading from operands.
All high-level functions to read from memory work on operands as sources.</dd><dt><a class="mod" href="operator/index.html" title="mod rustc_const_eval::interpret::operator">operator</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dt><a class="mod" href="place/index.html" title="mod rustc_const_eval::interpret::place">place</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Computations on places – field projections, going from mir::Place, and writing
into a place.
All high-level functions to write to memory work on places as destinations.</dd><dt><a class="mod" href="projection/index.html" title="mod rustc_const_eval::interpret::projection">projection</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>This file implements “place projections”; basically a symmetric API for 3 types: MPlaceTy, OpTy, PlaceTy.</dd><dt><a class="mod" href="stack/index.html" title="mod rustc_const_eval::interpret::stack">stack</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Manages the low-level pushing and popping of stack frames and the (de)allocation of local variables.
For handling of argument passing and return values, see the <code>call</code> module.</dd><dt><a class="mod" href="step/index.html" title="mod rustc_const_eval::interpret::step">step</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>This module contains the <code>InterpCx</code> methods for executing a single step of the interpreter.</dd><dt><a class="mod" href="traits/index.html" title="mod rustc_const_eval::interpret::traits">traits</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dt><a class="mod" href="util/index.html" title="mod rustc_const_eval::interpret::util">util</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dt><a class="mod" href="validity/index.html" title="mod rustc_const_eval::interpret::validity">validity</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Check the validity invariant of a given value, and tell the user
where in the value it got violated.
In const context, this goes even further and tries to approximate const safety.
That’s useful because it means other passes (e.g. promotion) can rely on <code>const</code>s
to be const-safe.</dd><dt><a class="mod" href="visitor/index.html" title="mod rustc_const_eval::interpret::visitor">visitor</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Visitor for a run-time value with a given layout: Traverse enums, structs and other compound
types until we arrive at the leaves, with custom handling for primitive types.</dd></dl><h2 id="macros" class="section-header">Macros<a href="#macros" class="anchor">§</a></h2><dl class="item-table"><dt><a class="macro" href="macro.compile_time_machine.html" title="macro rustc_const_eval::interpret::compile_time_machine">compile_<wbr>time_<wbr>machine</a></dt><dd>A lot of the flexibility above is just needed for <code>Miri</code>, but all “compile-time” machines
(CTFE and ConstProp) use the same instance. Here, we share that code.</dd></dl><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><dl class="item-table"><dt><a class="struct" href="struct.AllocInfo.html" title="struct rustc_const_eval::interpret::AllocInfo">Alloc<wbr>Info</a></dt><dd>Metadata about an <code>AllocId</code>.</dd><dt><a class="struct" href="struct.AllocRef.html" title="struct rustc_const_eval::interpret::AllocRef">Alloc<wbr>Ref</a></dt><dd>A reference to some allocation that was already bounds-checked for the given region
and had the on-access machine hooks run.</dd><dt><a class="struct" href="struct.AllocRefMut.html" title="struct rustc_const_eval::interpret::AllocRefMut">Alloc<wbr>RefMut</a></dt><dd>A reference to some allocation that was already bounds-checked for the given region
and had the on-access machine hooks run.</dd><dt><a class="struct" href="struct.Frame.html" title="struct rustc_const_eval::interpret::Frame">Frame</a></dt><dd>A stack frame.</dd><dt><a class="struct" href="struct.FrameInfo.html" title="struct rustc_const_eval::interpret::FrameInfo">Frame<wbr>Info</a></dt><dd>What we store about a frame in an interpreter backtrace.</dd><dt><a class="struct" href="struct.ImmTy.html" title="struct rustc_const_eval::interpret::ImmTy">ImmTy</a></dt><dt><a class="struct" href="struct.InterpCx.html" title="struct rustc_const_eval::interpret::InterpCx">Interp<wbr>Cx</a></dt><dt><a class="struct" href="struct.LocalState.html" title="struct rustc_const_eval::interpret::LocalState">Local<wbr>State</a></dt><dd>State of a local variable including a memoized layout</dd><dt><a class="struct" href="struct.MPlaceTy.html" title="struct rustc_const_eval::interpret::MPlaceTy">MPlace<wbr>Ty</a></dt><dd>A MemPlace with its layout. Constructing it is only possible in this module.</dd><dt><a class="struct" href="struct.Memory.html" title="struct rustc_const_eval::interpret::Memory">Memory</a></dt><dt><a class="struct" href="struct.OpTy.html" title="struct rustc_const_eval::interpret::OpTy">OpTy</a></dt><dt><a class="struct" href="struct.PlaceTy.html" title="struct rustc_const_eval::interpret::PlaceTy">PlaceTy</a></dt><dd>An evaluated place, together with its type.</dd><dt><a class="struct" href="struct.RangeSet.html" title="struct rustc_const_eval::interpret::RangeSet">Range<wbr>Set</a></dt><dd>Represents a set of <code>Size</code> values as a sorted list of ranges.</dd><dt><a class="struct" href="struct.RefTracking.html" title="struct rustc_const_eval::interpret::RefTracking">RefTracking</a></dt><dd>State for tracking recursive validation of references</dd><dt><a class="struct" href="struct.StackPopInfo.html" title="struct rustc_const_eval::interpret::StackPopInfo">Stack<wbr>PopInfo</a></dt><dd>Return type of <a href="struct.InterpCx.html#method.pop_stack_frame_raw" title="method rustc_const_eval::interpret::InterpCx::pop_stack_frame_raw"><code>InterpCx::pop_stack_frame_raw</code></a>.</dd></dl><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">§</a></h2><dl class="item-table"><dt><a class="enum" href="enum.AllocKind.html" title="enum rustc_const_eval::interpret::AllocKind">Alloc<wbr>Kind</a></dt><dd>The return value of <code>get_alloc_info</code> indicates the “kind” of the allocation.</dd><dt><a class="enum" href="enum.CtfeValidationMode.html" title="enum rustc_const_eval::interpret::CtfeValidationMode">Ctfe<wbr>Validation<wbr>Mode</a></dt><dd>Extra things to check for during validation of CTFE results.</dd><dt><a class="enum" href="enum.FnArg.html" title="enum rustc_const_eval::interpret::FnArg">FnArg</a></dt><dd>An argument passed to a function.</dd><dt><a class="enum" href="enum.FnVal.html" title="enum rustc_const_eval::interpret::FnVal">FnVal</a></dt><dd>The value of a function pointer.</dd><dt><a class="enum" href="enum.Immediate.html" title="enum rustc_const_eval::interpret::Immediate">Immediate</a></dt><dd>An <code>Immediate</code> represents a single immediate self-contained Rust value.</dd><dt><a class="enum" href="enum.InternError.html" title="enum rustc_const_eval::interpret::InternError">Intern<wbr>Error</a></dt><dt><a class="enum" href="enum.InternKind.html" title="enum rustc_const_eval::interpret::InternKind">Intern<wbr>Kind</a></dt><dd>How a constant value should be interned.</dd><dt><a class="enum" href="enum.MemPlaceMeta.html" title="enum rustc_const_eval::interpret::MemPlaceMeta">MemPlace<wbr>Meta</a></dt><dd>Information required for the sound usage of a <code>MemPlace</code>.</dd><dt><a class="enum" href="enum.MemoryKind.html" title="enum rustc_const_eval::interpret::MemoryKind">Memory<wbr>Kind</a></dt><dt><a class="enum" href="enum.OffsetMode.html" title="enum rustc_const_eval::interpret::OffsetMode">Offset<wbr>Mode</a></dt><dd>Describes the constraints placed on offset-projections.</dd><dt><a class="enum" href="enum.ReturnAction.html" title="enum rustc_const_eval::interpret::ReturnAction">Return<wbr>Action</a></dt><dd>Data returned by <a href="trait.Machine.html#method.after_stack_pop" title="associated function rustc_const_eval::interpret::Machine::after_stack_pop"><code>Machine::after_stack_pop</code></a>, and consumed by
<a href="struct.InterpCx.html#method.return_from_current_stack_frame" title="method rustc_const_eval::interpret::InterpCx::return_from_current_stack_frame"><code>InterpCx::return_from_current_stack_frame</code></a> to determine what actions should be done when
returning from a stack frame.</dd><dt><a class="enum" href="enum.ReturnContinuation.html" title="enum rustc_const_eval::interpret::ReturnContinuation">Return<wbr>Continuation</a></dt><dd>Where and how to continue when returning/unwinding from the current function.</dd></dl><h2 id="traits" class="section-header">Traits<a href="#traits" class="anchor">§</a></h2><dl class="item-table"><dt><a class="trait" href="trait.AllocMap.html" title="trait rustc_const_eval::interpret::AllocMap">Alloc<wbr>Map</a></dt><dd>The functionality needed by memory to manage its allocations</dd><dt><a class="trait" href="trait.EnteredTraceSpan.html" title="trait rustc_const_eval::interpret::EnteredTraceSpan">Entered<wbr>Trace<wbr>Span</a></dt><dd>A marker trait returned by <a href="trait.Machine.html#method.enter_trace_span" title="associated function rustc_const_eval::interpret::Machine::enter_trace_span">crate::interpret::Machine::enter_trace_span</a>, identifying either a
real <a href="https://docs.rs/tracing/0.1.37/tracing/span/struct.EnteredSpan.html" title="struct tracing::span::EnteredSpan">tracing::span::EnteredSpan</a> in case tracing is enabled, or the dummy type <code>()</code> when
tracing is disabled. Also see <a href="../macro.enter_trace_span.html" title="macro rustc_const_eval::enter_trace_span">crate::enter_trace_span!</a> below.</dd><dt><a class="trait" href="trait.HasStaticRootDefId.html" title="trait rustc_const_eval::interpret::HasStaticRootDefId">HasStatic<wbr>Root<wbr>DefId</a></dt><dt><a class="trait" href="trait.Machine.html" title="trait rustc_const_eval::interpret::Machine">Machine</a></dt><dd>Methods of this trait signifies a point where CTFE evaluation would fail
and some use case dependent behaviour can instead be applied.</dd><dt><a class="trait" href="trait.MayLeak.html" title="trait rustc_const_eval::interpret::MayLeak">MayLeak</a></dt><dd>Whether this kind of memory is allowed to leak</dd><dt><a class="trait" href="trait.Projectable.html" title="trait rustc_const_eval::interpret::Projectable">Projectable</a></dt><dd>A thing that we can project into, and that has a layout.</dd><dt><a class="trait" href="trait.ValueVisitor.html" title="trait rustc_const_eval::interpret::ValueVisitor">Value<wbr>Visitor</a></dt><dd>How to traverse a value and what to do when we are at the leaves.</dd><dt><a class="trait" href="trait.Writeable.html" title="trait rustc_const_eval::interpret::Writeable">Writeable</a></dt><dd>The <code>Weiteable</code> trait describes interpreter values that can be written to.</dd></dl><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">§</a></h2><dl class="item-table"><dt><a class="fn" href="fn.format_interp_error.html" title="fn rustc_const_eval::interpret::format_interp_error">format_<wbr>interp_<wbr>error</a></dt><dd>Turn the given error into a human-readable string. Expects the string to be printed, so if
<code>RUSTC_CTFE_BACKTRACE</code> is set this will show a backtrace of the rustc internals that
triggered the error.</dd><dt><a class="fn" href="fn.intern_const_alloc_for_constprop.html" title="fn rustc_const_eval::interpret::intern_const_alloc_for_constprop">intern_<wbr>const_<wbr>alloc_<wbr>for_<wbr>constprop</a></dt><dd>Intern <code>ret</code>. This function assumes that <code>ret</code> references no other allocation.</dd><dt><a class="fn" href="fn.intern_const_alloc_recursive.html" title="fn rustc_const_eval::interpret::intern_const_alloc_recursive">intern_<wbr>const_<wbr>alloc_<wbr>recursive</a></dt><dd>Intern <code>ret</code> and everything it references.</dd></dl></section></div></main></body></html>